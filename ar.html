<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>tracking.js - color with camera</title>
  <meta http-equiv="cache-control" content="max-age=0">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
  <meta http-equiv="pragma" content="no-cache">
  <script src="build/tracking-min.js"></script>
  <script src="build/dat.gui.min.js"></script>
  <!-- <script src="assets/stats.min.js"></script> -->
  <!-- <script src="assets/color_camera_gui.js"></script> -->
</head>
<style>
    video, canvas {
      position: absolute;     
      object-fit: cover;
      width:100%;
      height:100%;
    }
    </style>
<body>
      <div class="demo-frame">
        <div class="demo-container">
          <video id="video" preload autoplay loop muted></video>
          <canvas id="canvas"></canvas>
          <div id="block" style="z-index:999;width:200px;height:200px;position:absolute;top:50%; left:50%;transform:translateY(-50%)"></div>
        </div>
      </div>
    
      <script>
        window.addEventListener("resize", function(){
          var video = document.getElementById('video');
          var canvas = document.getElementById('canvas');
          video.width = window.innerWidth;
          video.height = window.innerHeight;
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
        });

        window.onload = function() {
          var video = document.getElementById('video');
          var canvas = document.getElementById('canvas');
          video.width = window.innerWidth;
          video.height = window.innerHeight;
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
          var context = canvas.getContext('2d');
          tracking.ColorTracker.registerColor('black', function(r, g, b) {
            if (r < 50 && g < 50 && b < 50) {
              return true;
              console.log("black")
            }
            return false;
          });
          tracking.ColorTracker.registerColor('white', function(r, g, b) {
            if (r > 200 && g > 200 && b > 200) {
              return true;
            }
            return false;
          });
          var tracker = new tracking.ColorTracker(['magenta', 'cyan', 'yellow', 'black','white']);
          tracking.track('#video', tracker, { camera: true });
          tracking.ColorTracker.prototype.minDimension = 1;
          tracking.ColorTracker.prototype.minGroupSize = 1;
          tracker.on('track', function(event) {
            const tab = new Array();
            const element = document.getElementById('block');
            context.clearRect(0, 0, canvas.width, canvas.height);
            event.data.forEach(function(rect) {
              if (rect.color === 'custom') {
                rect.color = tracker.customColor;
              }
              context.strokeStyle = rect.color;
              context.strokeRect(rect.x, rect.y, rect.width, rect.height);
              context.font = '11px Helvetica';
              context.fillStyle = "#fff";
              context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);
              context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);
              // tab.push(rect.color);
            // console.log("1 "+tab)
            element.style.background = rect.color;
            });
          });
        //  initGUIControllers(tracker);
        };
      </script>
</body>
</html>